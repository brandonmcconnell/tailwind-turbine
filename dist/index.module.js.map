{"version":3,"file":"index.module.js","sources":["../index.ts"],"sourcesContent":["import type { Config } from 'tailwindcss';\nimport tailwindPlugin from 'tailwindcss/plugin.js';\n\ntype PossiblyInvoked<T extends (...args: any[]) => any> = T | ReturnType<T>;\n\n// Plugin Types\ntype TailwindPluginBase = typeof tailwindPlugin;\ntype TailwindPlugin = ReturnType<TailwindPluginBase> | PossiblyInvoked<ReturnType<TailwindPluginBase['withOptions']>>;\ntype TurbinePluginBase = {\n  transform?: (config: NormalizedConfig) => NormalizedConfig;\n  plugins?: TailwindPlugin[];\n};\nexport type TurbinePlugin = TurbinePluginBase | ((...params: any[]) => TurbinePluginBase);\ntype Plugin = TurbinePlugin | TailwindPlugin;\n\n// Tailwind Plugin Type Guard\nfunction hasTailwindHandler(plugin: Plugin) {\n  return 'handler' in plugin && typeof plugin.handler === 'function';\n}\nfunction isTailwindPlugin(plugin: Plugin): plugin is TailwindPlugin {\n  if (hasTailwindHandler(plugin)) return true;\n  if (typeof plugin === 'function' && hasTailwindHandler(plugin({}))) return true;\n  return false;\n}\n\n// Turbine Plugin Type Guard\nfunction hasTurbineTransform(plugin: Plugin) {\n  return 'transform' in plugin && typeof plugin.transform === 'function';\n}\nfunction isTurbinePlugin(plugin: Plugin): plugin is TurbinePlugin {\n  if (hasTurbineTransform(plugin)) return true;\n  if (typeof plugin === 'function' && hasTurbineTransform(plugin({}))) return true;\n  return false;\n}\n\ntype NonNullableTheme = NonNullable<Config['theme']>;\ninterface NormalizedTheme extends NonNullableTheme {\n  // Responsiveness\n  supports: NonNullable<NonNullableTheme['supports']>;\n  data: NonNullable<NonNullableTheme['data']>;\n  // Reusable base configs\n  colors: NonNullable<NonNullableTheme['colors']>;\n  spacing: NonNullable<NonNullableTheme['spacing']>;\n  // Components\n  container: NonNullable<NonNullableTheme['container']>;\n}\n\ninterface NormalizedConfig extends Config {\n  safelist: NonNullable<Config['safelist']>;\n  blocklist: NonNullable<Config['blocklist']>;\n  presets: NonNullable<Config['presets']>;\n  theme: NormalizedTheme;\n  plugins: NonNullable<Config['plugins']>;\n}\n\nconst createNormalizedThemeObject = (): NormalizedTheme => ({\n  supports: {},\n  data: {},\n  colors: {},\n  spacing: {},\n  container: {},\n});\n\nconst normalizeConfig = (config: Config): NormalizedConfig => {\n  config.safelist ??= [] satisfies NormalizedConfig['safelist'];\n  config.blocklist ??= [] satisfies NormalizedConfig['blocklist'];\n  config.presets ??= [] satisfies NormalizedConfig['presets'];\n  config.theme = {\n    ...createNormalizedThemeObject(),\n    ...(config.theme ?? {}),\n    extend: {\n      ...createNormalizedThemeObject(),\n      ...(config.theme?.extend ?? {}),\n    },\n  } satisfies NormalizedTheme & { extend: NormalizedTheme };\n  config.theme.extend ??= {} satisfies NormalizedConfig['theme']['extend'];\n  config.plugins ??= [] satisfies NormalizedConfig['plugins'];\n  return config as NormalizedConfig;\n};\n\n// Turbine Plugin Builder\nconst Turbine = {\n  build({\n    config: CONFIG_RAW,\n    plugins,\n    // reporting, // Coming soon ðŸ‘€\n  }: {\n    config: Config;\n    plugins: Plugin[];\n    // reporting?: boolean;\n  }) {\n    let i = 0;\n    let config = normalizeConfig(CONFIG_RAW);\n    for (const plugin of plugins) {\n      if (isTailwindPlugin(plugin)) {\n        config.plugins.push(plugin);\n      } else if (isTurbinePlugin(plugin)) {\n        const { transform, plugins } = typeof plugin === 'function' ? plugin() : plugin;\n        if (transform) {\n          config = transform(config);\n        }\n        if (plugins) {\n          config.plugins.push(...plugins);\n        }\n      } else {\n        throw new Error(`Invalid Turbine plugin at position ${i}, did not match Tailwind CSS or Turbine plugin.`);\n      }\n      i++;\n    }\n    return config as NormalizedConfig;\n  },\n};\n\nexport default Turbine;\n"],"names":["hasTailwindHandler","plugin","handler","isTailwindPlugin","hasTurbineTransform","transform","isTurbinePlugin","Turbine","build","_ref","_step","plugins","i","config","_config$theme","_config$theme$extend","_config$theme2","_config$theme3","safelist","blocklist","presets","theme","_extends","supports","data","colors","spacing","container","extend","normalizeConfig","_iterator","_createForOfIteratorHelperLoose","done","value","push","Error","_config$plugins2","_ref2","apply"],"mappings":"8UAgBA,SAASA,EAAmBC,GAC1B,MAAO,YAAaA,GAAoC,mBAAnBA,EAAOC,OAC9C,CACA,SAASC,EAAiBF,GACxB,QAAID,EAAmBC,MACD,mBAAXA,IAAyBD,EAAmBC,EAAO,CAAA,IAEhE,CAGA,SAASG,EAAoBH,GAC3B,MAAO,cAAeA,GAAsC,mBAArBA,EAAOI,SAChD,CACA,SAASC,EAAgBL,GACvB,QAAIG,EAAoBH,MACF,mBAAXA,IAAyBG,EAAoBH,EAAO,CAAE,IAEnE,CAsBA,IA0BMM,EAAU,CACdC,MAAK,SAAAC,GAWH,IAHD,IAG6BC,EAT5BC,EAAOF,EAAPE,QAOIC,EAAI,EACJC,EA7BgB,SAACA,GAAoC,IAAAC,EAAAC,EAAAC,EAAAC,EAc3D,OAbe,MAAfJ,EAAOK,WAAPL,EAAOK,SAAa,IACJ,MAAhBL,EAAOM,YAAPN,EAAOM,UAAc,IACP,MAAdN,EAAOO,UAAPP,EAAOO,QAAY,IACnBP,EAAOQ,MAAKC,EAAA,CAAA,EAZ8C,CAC1DC,SAAU,CAAA,EACVC,KAAM,CAAA,EACNC,OAAQ,CAAE,EACVC,QAAS,CAAE,EACXC,UAAW,CACZ,GAQmBb,OADgBA,EAC5BD,EAAOQ,OAAKP,EAAI,CAAA,EAAE,CACtBc,OAAMN,EAAA,GAfkD,CAC1DC,SAAU,CAAA,EACVC,KAAM,CAAA,EACNC,OAAQ,CAAE,EACVC,QAAS,CAAE,EACXC,UAAW,CACZ,GAW6BZ,OADQA,EAC5BC,OAD4BA,EAC5BH,EAAOQ,YAAPL,EAAAA,EAAcY,QAAMb,EAAI,CAAE,KAGf,OAAnBE,EAAAJ,EAAOQ,OAAMO,SAAbX,EAAaW,OAAW,CAAgD,GAC1D,MAAdf,EAAOF,UAAPE,EAAOF,QAAY,IACZE,CACT,CAciBgB,CATKpB,EAAlBI,QAUAiB,2qBAAAC,CAAqBpB,KAAOD,EAAAoB,KAAAE,MAAE,CAAA,IAAnB/B,EAAMS,EAAAuB,MACf,GAAI9B,EAAiBF,GACnBY,EAAOF,QAAQuB,KAAKjC,OACXK,KAAAA,EAAgBL,GASzB,MAAM,IAAIkC,MAA4CvB,sCAAAA,EAAkD,mDARxG,IAIawB,EAJbC,EAAiD,mBAAXpC,EAAwBA,IAAWA,EAAjEI,EAASgC,EAAThC,UAAWM,EAAO0B,EAAP1B,QACfN,IACFQ,EAASR,EAAUQ,IAEjBF,IACFyB,EAAAvB,EAAOF,SAAQuB,KAAII,MAAAF,EAAIzB,EAI3B,CACAC,GACF,CACA,OAAOC,CACT"}